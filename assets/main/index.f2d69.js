System.register("chunks:///_virtual/Drawing.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Grid.ts"],(function(i){var t,n,o,e,r,s,a,h,c,l,u,p,g,f,d,T,P,D;return{setters:[function(i){t=i.applyDecoratedDescriptor,n=i.inheritsLoose,o=i.createForOfIteratorHelperLoose,e=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){s=i.cclegacy,a=i._decorator,h=i.Camera,c=i.Prefab,l=i.Graphics,u=i.UITransform,p=i.sys,g=i.input,f=i.Input,d=i.instantiate,T=i.Color,P=i.Component},function(i){D=i.Grid}],execute:function(){var v,w,y,E,M,b,C,m,O,S,U,_,A;s._RF.push({},"44ea89fcS5PXpVQMautyHBJ","Drawing",void 0);var L=a.ccclass,H=a.property;i("Drawing",(v=L("Drawing"),w=H(h),y=H(D),E=H(c),v((C=t((b=function(i){function t(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return t=i.call.apply(i,[this].concat(o))||this,e(t,"camera",C,r(t)),e(t,"grid",m,r(t)),e(t,"snapDistance",O,r(t)),e(t,"lineWidth",S,r(t)),e(t,"pointColor",U,r(t)),e(t,"lineColor",_,r(t)),e(t,"particlePrefab",A,r(t)),t.graphics=null,t.uiTransform=null,t.points=[],t.isDrawing=!1,t.currentPosition=null,t.dragParticle=null,t}n(t,i);var s=t.prototype;return s.start=function(){this.graphics=this.getComponent(l),this.uiTransform=this.getComponent(u),p.isMobile?(g.on(f.EventType.TOUCH_START,this.onTouchStart,this),g.on(f.EventType.TOUCH_MOVE,this.onTouchMove,this),g.on(f.EventType.TOUCH_END,this.onTouchEnd,this),g.on(f.EventType.TOUCH_CANCEL,this.onTouchEnd,this)):(g.on(f.EventType.MOUSE_DOWN,this.onMouseDown,this),g.on(f.EventType.MOUSE_MOVE,this.onMouseMove,this),g.on(f.EventType.MOUSE_UP,this.onMouseUp,this))},s.onMouseDown=function(i){0===i.getButton()&&this.startDrawingAtScreenPos(i.getLocation())},s.onMouseMove=function(i){this.isDrawing&&this.updateDrawing(i.getLocation())},s.onMouseUp=function(i){0===i.getButton()&&this.finishDrawing()},s.onTouchStart=function(i){i.getAllTouches().length>=2||this.startDrawingAtScreenPos(i.getLocation())},s.onTouchMove=function(i){this.isDrawing&&this.updateDrawing(i.getLocation())},s.onTouchEnd=function(i){this.finishDrawing()},s.getLocalPosFromScreen=function(i){var t=this.camera.screenToWorld(i.toVec3());return this.uiTransform.convertToNodeSpaceAR(t).toVec2()},s.startDrawingAtScreenPos=function(i){var t=this.getLocalPosFromScreen(i),n=this.grid.getGridPoint(t);n&&(n.dist<=this.snapDistance&&this.points.push(n.position),this.points=[n.position],this.isDrawing=!0,this.currentPosition=t,this.drawAll(),this.createDragParticle())},s.updateDrawing=function(i){var t=this.getLocalPosFromScreen(i),n=this.grid.getGridPoint(t);n&&n.dist<=this.snapDistance&&!this.points[this.points.length-1].equals(n.position)&&this.points.push(n.position),this.currentPosition=t,this.drawAll(),this.updateDragParticle()},s.finishDrawing=function(){this.isDrawing&&this.currentPosition&&(this.isDrawing=!1,this.currentPosition=null,this.drawAll(),this.deleteDragParticle())},s.drawAll=function(){if(this.graphics.clear(),this.points.length>1){this.graphics.lineWidth=this.lineWidth,this.graphics.strokeColor=this.lineColor,this.graphics.moveTo(this.points[0].x,this.points[0].y);for(var i=1;i<this.points.length;i++)this.graphics.lineTo(this.points[i].x,this.points[i].y);this.graphics.stroke()}if(this.isDrawing&&this.currentPosition&&this.points.length>0){var t=this.points[this.points.length-1];this.graphics.lineWidth=this.lineWidth,this.graphics.moveTo(t.x,t.y),this.graphics.lineTo(this.currentPosition.x,this.currentPosition.y),this.graphics.stroke()}this.graphics.fillColor=this.pointColor;for(var n,e=1.5*this.lineWidth,r=o(this.points);!(n=r()).done;){var s=n.value;this.graphics.circle(s.x,s.y,e),this.graphics.fill()}this.currentPosition&&(this.graphics.circle(this.currentPosition.x,this.currentPosition.y,e),this.graphics.fill())},s.createDragParticle=function(){var i=d(this.particlePrefab);this.node.addChild(i),i.setPosition(this.currentPosition.toVec3()),this.dragParticle=i},s.updateDragParticle=function(){this.dragParticle.setPosition(this.currentPosition.toVec3())},s.deleteDragParticle=function(){this.dragParticle.destroy(),this.dragParticle=null},s.clearDrawing=function(){this.points=[],this.isDrawing=!1,this.currentPosition=null,this.graphics&&this.graphics.clear()},s.getDrawnPoints=function(){for(var i,t=[],n=o(this.points);!(i=n()).done;){var e=i.value,r=this.grid.getGridPoint(e);r&&t.push({col:r.col,row:r.row})}return t},s.onDestroy=function(){g.off(f.EventType.MOUSE_DOWN,this.onMouseDown,this),g.off(f.EventType.MOUSE_MOVE,this.onMouseMove,this),g.off(f.EventType.MOUSE_UP,this.onMouseUp,this),g.off(f.EventType.TOUCH_START,this.onTouchStart,this),g.off(f.EventType.TOUCH_MOVE,this.onTouchMove,this),g.off(f.EventType.TOUCH_END,this.onTouchEnd,this),g.off(f.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},t}(P)).prototype,"camera",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=t(b.prototype,"grid",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(b.prototype,"snapDistance",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),S=t(b.prototype,"lineWidth",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),U=t(b.prototype,"pointColor",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T(255,0,0,255)}}),_=t(b.prototype,"lineColor",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T(0,0,255,255)}}),A=t(b.prototype,"particlePrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=b))||M));s._RF.pop()}}}));

System.register("chunks:///_virtual/GameCamera.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,o,e,n,s,h,a,r,c,u,l,p,m,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,o=t.inheritsLoose,e=t.createClass,n=t.initializerDefineProperty,s=t.assertThisInitialized},function(t){h=t.cclegacy,a=t._decorator,r=t.Camera,c=t.sys,u=t.input,l=t.Input,p=t.Vec3,m=t.Vec2,f=t.Component}],execute:function(){var g,T,M,y,v;h._RF.push({},"0bf723SNp9FU4839l0H/bvg","GameCamera",void 0);var E=a.ccclass,S=a.property;t("GameCamera",E("GameCamera")((M=i((T=function(t){function i(){for(var i,o=arguments.length,e=new Array(o),h=0;h<o;h++)e[h]=arguments[h];return(i=t.call.apply(t,[this].concat(e))||this).camera=null,n(i,"minZoom",M,s(i)),n(i,"maxZoom",y,s(i)),n(i,"zoomSpeed",v,s(i)),i.initialZoom=0,i.isDragging=!1,i.lastMousePos=new p,i.pinchStartDist=0,i.pinchStartOrtho=0,i.isPinching=!1,i.lastPinchMidScreen=new m,i}o(i,t);var h=i.prototype;return h.start=function(){this.camera=this.getComponent(r),this.initialZoom=this.camera.orthoHeight,c.isMobile?(u.on(l.EventType.TOUCH_START,this.onTouchStart,this),u.on(l.EventType.TOUCH_MOVE,this.onTouchMove,this),u.on(l.EventType.TOUCH_END,this.onTouchEnd,this),u.on(l.EventType.TOUCH_CANCEL,this.onTouchEnd,this)):(u.on(l.EventType.MOUSE_WHEEL,this.onMouseWheel,this),u.on(l.EventType.MOUSE_DOWN,this.onMouseDown,this),u.on(l.EventType.MOUSE_MOVE,this.onMouseMove,this),u.on(l.EventType.MOUSE_UP,this.onMouseUp,this))},h.clampZoom=function(){this.camera.orthoHeight=Math.max(this.minZoom,Math.min(this.camera.orthoHeight,this.maxZoom))},h.onMouseWheel=function(t){var i=t.getScrollY();this.camera.orthoHeight-=i*this.zoomSpeed,this.clampZoom()},h.onMouseDown=function(t){if(1===t.getButton()){this.isDragging=!0;var i=t.getLocation();this.lastMousePos.set(i.x,i.y,0)}},h.onMouseUp=function(t){1===t.getButton()&&(this.isDragging=!1)},h.onMouseMove=function(t){if(this.isDragging){var i=t.getLocation(),o=i.x-this.lastMousePos.x,e=i.y-this.lastMousePos.y;this.lastMousePos.set(i.x,i.y,0);var n=new p(-o,-e,0);n.multiplyScalar(this.zoomFactor),this.camera.node.position=this.camera.node.position.add(n)}},h.getTwoTouchesPositions=function(t){var i=t.getAllTouches();return i.length<2?[]:[i[0].getLocation(),i[1].getLocation()]},h.distance=function(t,i){var o=t.x-i.x,e=t.y-i.y;return Math.sqrt(o*o+e*e)},h.onTouchStart=function(t){if(2===t.getAllTouches().length){var i=this.getTwoTouchesPositions(t),o=i[0],e=i[1];this.pinchStartDist=this.distance(o,e),this.pinchStartOrtho=this.camera.orthoHeight;var n=.5*(o.x+e.x),s=.5*(o.y+e.y);this.lastPinchMidScreen.set(n,s),this.isPinching=!0}},h.onTouchMove=function(t){if(this.isPinching){var i=this.getTwoTouchesPositions(t);if(!(i.length<2)){var o=this.distance(i[0],i[1]);if(!(this.pinchStartDist<=0)){var e=o/this.pinchStartDist;this.camera.orthoHeight=this.pinchStartOrtho/e,this.clampZoom();var n=.5*(i[0].x+i[1].x),s=.5*(i[0].y+i[1].y),h=n-this.lastPinchMidScreen.x,a=s-this.lastPinchMidScreen.y,r=new p(-h,-a,0);r.multiplyScalar(this.zoomFactor),this.camera.node.position=this.camera.node.position.add(r),this.lastPinchMidScreen.set(n,s)}}}},h.onTouchEnd=function(t){t.getAllTouches().length<2&&(this.isPinching=!1,this.pinchStartDist=0)},h.onDestroy=function(){u.off(l.EventType.MOUSE_WHEEL,this.onMouseWheel,this),u.off(l.EventType.MOUSE_DOWN,this.onMouseDown,this),u.off(l.EventType.MOUSE_MOVE,this.onMouseMove,this),u.off(l.EventType.MOUSE_UP,this.onMouseUp,this),u.off(l.EventType.TOUCH_START,this.onTouchStart,this),u.off(l.EventType.TOUCH_MOVE,this.onTouchMove,this),u.off(l.EventType.TOUCH_END,this.onTouchEnd,this),u.off(l.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e(i,[{key:"zoomFactor",get:function(){return this.camera.orthoHeight/this.initialZoom}}]),i}(f)).prototype,"minZoom",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 300}}),y=i(T.prototype,"maxZoom",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 800}}),v=i(T.prototype,"zoomSpeed",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.05}}),g=T))||g);h._RF.pop()}}}));

System.register("chunks:///_virtual/Grid.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,r,e,s,l,h,o,a,n,c;return{setters:[function(i){t=i.applyDecoratedDescriptor,r=i.inheritsLoose,e=i.createForOfIteratorHelperLoose,s=i.initializerDefineProperty,l=i.assertThisInitialized},function(i){h=i.cclegacy,o=i._decorator,a=i.Vec2,n=i.Graphics,c=i.Component}],execute:function(){var u,f,p,d,g,z,w,v;h._RF.push({},"65cb9BXI0hGHJsjt1Eapu1B","Grid",void 0);var y=o.ccclass,S=o.property;i("Grid",(u=y("Grid"),f=S({type:[a]}),u((g=t((d=function(i){function t(){for(var t,r=arguments.length,e=new Array(r),h=0;h<r;h++)e[h]=arguments[h];return(t=i.call.apply(i,[this].concat(e))||this).graphics=null,s(t,"rows",g,l(t)),s(t,"cols",z,l(t)),s(t,"cellSize",w,l(t)),s(t,"specialPoints",v,l(t)),t.gridWidth=0,t.gridHeight=0,t.halfW=0,t.halfH=0,t}r(t,i);var h=t.prototype;return h.start=function(){this.graphics=this.getComponent(n),this.calculateGridDimensions(),this.drawGrid()},h.calculateGridDimensions=function(){this.gridWidth=(this.cols-1)*this.cellSize,this.gridHeight=(this.rows-1)*this.cellSize,this.halfW=.5*this.gridWidth,this.halfH=.5*this.gridHeight},h.drawGrid=function(){this.graphics.clear(),this.graphics.fillColor.fromHEX("#666666");for(var i=0;i<this.rows;i++)for(var t=-this.halfH+i*this.cellSize,r=0;r<this.cols;r++){var s=-this.halfW+r*this.cellSize;this.graphics.circle(s,t,this.graphics.lineWidth),this.graphics.fill()}for(var l,h=e(this.specialPoints);!(l=h()).done;){var o=l.value,a=o.x,n=o.y;if(!(n<0||n>=this.rows||a<0||a>=this.cols)){var c=-this.halfW+a*this.cellSize,u=-this.halfH+n*this.cellSize;this.graphics.fillColor.fromHEX("#ff0000"),this.graphics.circle(c,u,1.5*this.graphics.lineWidth),this.graphics.fill()}}},h.getGridPoint=function(i){var t=(i.x+this.halfW)/this.cellSize,r=(i.y+this.halfH)/this.cellSize,e=Math.round(t),s=Math.round(r);if(e<0||e>=this.cols||s<0||s>=this.rows)return null;var l=-this.halfW+e*this.cellSize,h=-this.halfH+s*this.cellSize,o=i.x-l,n=i.y-h,c=Math.sqrt(o*o+n*n),u=this.specialPoints.some((function(i){return i.x===e&&i.y===s}));return{col:e,row:s,dist:c,isSpecial:u,position:new a(l,h)}},h.getWorldPosition=function(i,t){var r=-this.halfW+i*this.cellSize,e=-this.halfH+t*this.cellSize;return new a(r,e)},h.updateGrid=function(i,t,r){this.rows=i,this.cols=t,this.cellSize=r,this.calculateGridDimensions(),this.drawGrid()},t}(c)).prototype,"rows",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),z=t(d.prototype,"cols",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),w=t(d.prototype,"cellSize",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),v=t(d.prototype,"specialPoints",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),p=d))||p));h._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Drawing.ts","./GameCamera.ts","./Grid.ts"],(function(){return{setters:[null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});